!function e(n,t,r){function a(i,c){if(!t[i]){if(!n[i]){var s="function"==typeof require&&require;if(!c&&s)return s(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=t[i]={exports:{}};n[i][0].call(l.exports,function(e){var t=n[i][1][e];return a(t?t:e)},l,l.exports,e,n,t,r)}return t[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,n,t){"use strict";function r(e){e.setPrefix("debtApp")}function a(e){var n=["action","alert","content","navigation"],t=s.map(n,function(e){var n="svg-sprite-"+e+".svg";return{filePath:"resources/icons/"+n,spriteName:e}});s.each(t,function(n){e.iconSet(n.spriteName,n.filePath)})}function o(e){e.aHrefSanitizationWhitelist(/^(blob||https?):/)}function i(e,n,t){e.$state=n,e.$stateParams=t}var c=e("angular");e("angular-material"),e("angular-route"),e("angular-ui-router"),e("angular-local-storage"),e("ng-mfb"),e("ng-file-upload");var s=e("lodash");c.module("debtApp",["ngMaterial","ui.router","LocalStorageModule","ng-mfb","ngFileUpload"]).constant("events",{BALANCE_SHEET_UPDATED:"balance sheet updated"}).config(r).config(a).config(o).run(i),e("./debt-app-ctrl"),e("./route-config"),e("./debts"),e("./balance-sheet"),e("./persons"),e("./expenses"),e("./utils"),r.$inject=["localStorageServiceProvider"],a.$inject=["$mdIconProvider"],o.$inject=["$compileProvider"],i.$inject=["$rootScope","$state","$stateParams"]},{"./balance-sheet":5,"./debt-app-ctrl":7,"./debts":10,"./expenses":15,"./persons":19,"./route-config":22,"./utils":23,angular:"angular","angular-local-storage":"angular-local-storage","angular-material":"angular-material","angular-route":"angular-route","angular-ui-router":"angular-ui-router",lodash:"lodash","ng-file-upload":"ng-file-upload","ng-mfb":"ng-mfb"}],2:[function(e,n,t){"use strict";function r(e,n,t,r){function a(){o(),r.$on(t.BALANCE_SHEET_UPDATED,s.refresh)}function o(){s.balanceSheet=e.balanceSheet,s.debtsByDebtor=i()}function i(){if(s.balanceSheet.isBalanced()){var e=s.balanceSheet.getNonSettledParticipations(),t=n.computeDebts(e);return n.organizeByDebtor(t)}return void 0}function c(){r.$emit(t.BALANCE_SHEET_UPDATED)}var s=this;s.init=a,s.refresh=o,s.updateSheet=c,a()}var a=(e("lodash"),e("angular"));a.module("debtApp").controller("BalanceSheetCtrl",r),r.$inject=["balanceSheetService","debtService","events","$scope"]},{angular:"angular",lodash:"lodash"}],3:[function(e,n,t){"use strict";function r(e){function n(){var n=e.get("balanceSheetData");try{s.balanceSheet=new o(n),s.error=void 0}catch(t){s.error=t}}function t(){if(!s.balanceSheet)throw s.error;try{s.balanceSheet.throwErrorIfInvalid()}catch(n){throw s.error=n,n}e.set("balanceSheetData",s.balanceSheet.exportData()),s.error=void 0}function r(e){var n=a.fromJson(e);s.balanceSheet=new o(n),t()}function i(){var e=s.balanceSheet.exportData();return a.toJson(e)}function c(){s.balanceSheet=new o,s.save()}var s={balanceSheet:void 0,error:void 0,save:t,loadFromJson:r,exportToJson:i,createNew:c,init:n};return s.init(),s}var a=(e("lodash"),e("angular")),o=e("./balance-sheet");a.module("debtApp").factory("balanceSheetService",r),r.$inject=["localStorageService"]},{"./balance-sheet":4,angular:"angular",lodash:"lodash"}],4:[function(e,n,t){"use strict";var r=e("lodash"),a=(e("angular"),e("simple-decimal-money")),o=function(e){function n(){return r.filter(w,function(e){return!e.expense.settled})}function t(){return r.reduce($,function(e,n){return e&&(n.settled||n.isBalanced())},!0)}function o(e){return r(P).find(function(n){return n.id==e})}function i(e,n){e=r.extend({name:"Person "+(P.length+1)},e),n=r.extend({},n),void 0===e.id&&(e.id=D,D+=1);var t=new h(e);return P.push(t),n.createParticipations===!0&&r.each($,function(e){e.settled||(p({person:t,expense:e}),e.shareCost())}),t}function c(e){e=o(e.id),e&&(r.remove(P,function(n){return n.equals(e)}),r.forEach(e.getParticipations(),function(e){d(e)}))}function s(e){return r($).find(function(n){return n.id==e})}function u(e,n){e=r.extend({name:"Expense "+($.length+1),sharing:"equal",settled:!1},e),n=r.extend({},n),void 0===e.id&&(e.id=D,D+=1);var t=new v(e);return $.push(t),n.createParticipations===!0&&r.each(P,function(e){p({person:e,expense:t})}),t}function l(e){e=s(e.id),e&&(r.remove($,function(n){return n.equals(e)}),r.forEach(e.getParticipations(),function(e){d(e)}))}function f(e){var n=new b(e);return r(w).find(function(e){return n.equals(e)})}function p(e){if(f(e))throw"Duplicate participation";e=r.extend({paid:0,share:0},e);var n=new b(e);return w.push(n),n.expense.shareCost(),n}function d(e){e=f(e),e&&(r.remove(w,function(n){return n.equals(e)}),e.expense.shareCost())}function h(e){function n(){return p.value().toNumber()}function t(){return d.value().toNumber()}function o(){return 0===v.value().toNumber()}function i(){return v.value().toNumber()}function c(){return l.value()}function s(e){return e instanceof h&&e.id===u.id}var u=this;r.extend(u,e),u.equals=s,u.getCost=n,u.getSumOfShares=t,u.getBalance=i,u.isBalanced=o,u.getParticipations=c;var l=r.chain(w).filter(function(e){return u.equals(e.person)}),f=l.filter(function(e){return!e.expense.settled}),p=f.filter(function(e){return!e.expense.settled}).map("paid").reduce(function(e,n){return e.add(n)},new a(0)),d=f.map("share").reduce(function(e,n){return e.add(n)},new a(0)),v=f.map(function(e){return new a(e.share).subtract(e.paid)}).reduce(function(e,n){return e.add(n)},new a(0))}function v(e){function n(){return d.value().toNumber()}function t(){return h.value().toNumber()}function o(){return 0===b.value().toNumber()}function i(){return b.value().toNumber()}function c(){return p.value()}function s(){"equal"===f.sharing&&u()}function u(){var e=f.getParticipations();if(0!==e.length){var n=new a(f.getCost()),t=n.divideBy(e.length),o=n.subtract(t.multiply(e.length-1));r.forEach(e,function(n,r){r<e.length-1&&(n.share=t.toNumber())}),r.last(e).share=o.toNumber()}}function l(e){return e instanceof v&&e.id===f.id}var f=this;r.extend(f,e),f.getCost=n,f.getSumOfShares=t,f.getBalance=i,f.isBalanced=o,f.getParticipations=c,f.shareCost=s,f.equals=l;var p=r.chain(w).filter(function(e){return f.equals(e.expense)}),d=p.map("paid").reduce(function(e,n){return e.add(n)},new a(0)),h=p.map("share").reduce(function(e,n){return e.add(n)},new a(0)),b=p.map(function(e){return new a(e.share).subtract(e.paid)}).reduce(function(e,n){return e.add(n)},new a(0))}function b(e){function n(e){return e instanceof b&&t.expense.equals(e.expense)&&t.person.equals(e.person)}var t=this;if(!e||!e.person||!e.expense)throw"Undefined participation";r.extend(this,e),this.equals=n}function g(){var e=r.negate(r.isFunction),n=r.pick(A,e);return n.persons=r.map(P,function(n){return r.pick(n,e)}),n.expenses=r.map($,function(n){return r.pick(n,e)}),n.participations=r.map(w,function(e){return{personId:e.person.id,expenseId:e.expense.id,paid:e.paid,share:e.share}}),n}function m(e){D=r([]).concat(e.persons).concat(e.expenses).pluck("id").max()+1,D==-(1/0)&&(D=1);var n={persons:!0,expenses:!0,participations:!0};r.extend(A,r.pick(e,function(e,t){return!n[t]})),r.each(e.persons,function(e){i(e)}),r.each(e.expenses,function(e){u(e)}),r.each(e.participations,function(e){var n=o(e.personId),t=s(e.expenseId);p({person:n,expense:t,paid:e.paid,share:e.share})}),S()}function x(){try{return S(),!0}catch(e){return!1}}function S(){r.each(P,function(e){if(!r.isNumber(e.id))throw new E("Person has no id")}),r.each($,function(e){if(!r.isNumber(e.id))throw new E("Expense has no id")});var e={};r.each(P,function(n){e[n.id]=n}),r.each($,function(n){e[n.id]=n}),r.each(w,function(n){if(!n.person)throw new E("Participation has no person");if(!e[n.person.id])throw new E("Participation person is unknown");if(!n.expense)throw new E("Participation has no expense");if(!e[n.expense.id])throw new E("Participation expense is unknown")})}function E(e){this.message=e}var A=this,P=[],$=[],w=[],D=1;A.name="New sheet",A.persons=P,A.expenses=$,A.participations=w,e&&m(e),A.getNonSettledParticipations=n,A.isBalanced=t,A.getPerson=o,A.createPerson=i,A.removePerson=c,A.getExpense=s,A.createExpense=u,A.removeExpense=l,A.getParticipation=f,A.createParticipation=p,A.removeParticipation=d,A.exportData=g,A.isValid=x,A.throwErrorIfInvalid=S};n.exports=o},{angular:"angular",lodash:"lodash","simple-decimal-money":"simple-decimal-money"}],5:[function(e,n,t){"use strict";e("./route-config"),e("./balance-sheet"),e("./balance-sheet-service"),e("./balance-sheet-ctrl")},{"./balance-sheet":4,"./balance-sheet-ctrl":2,"./balance-sheet-service":3,"./route-config":6}],6:[function(e,n,t){"use strict";function r(e){e.state("balanceSheet",{url:"/",templateUrl:"balance-sheet/balance-sheet.html",controller:"BalanceSheetCtrl as vm"})}var a=e("angular");a.module("debtApp").config(r),r.$inject=["$stateProvider"]},{angular:"angular"}],7:[function(e,n,t){"use strict";function r(e,n,t,r,i,c,s,u,l,f,p){function d(){s("main-menu").toggle()}function h(){w=(f.URL||f.webkitURL||{}).createObjectURL||a.noop,D=(f.URL||f.webkitURL||{}).revokeObjectURL||a.noop,C=f.Blob||a.noop,y=f.FileReader||a.noop,l.$on(i.BALANCE_SHEET_UPDATED,o.debounce(v,n.wait)),$.refresh()}function v(){$.refresh(),$.errorMessage||$.save()}function b(){try{e.save(),$.errorMessage=void 0,p.debug("Balance sheet saved")}catch(n){$.errorMessage="Cannot save: "+n.message,p.error("Error when saving balance sheet: "+n.message)}}function g(){$.balanceSheet=e.balanceSheet,$.errorMessage=e.error?"Invalid sheet: "+e.error.message:void 0,m()}function m(){var n=e.exportToJson(),t=new C([n],{type:"application/json"});D($.jsonExportUrl),$.jsonExportUrl=w(t)}function x(){t().then(function(n){e.balanceSheet.createPerson(n.person,n.options),v(),l.$broadcast(i.BALANCE_SHEET_UPDATED)})}function S(){r().then(function(n){e.balanceSheet.createExpense(n.expense,n.options),v(),l.$broadcast(i.BALANCE_SHEET_UPDATED)})}function E(){c.show(N).then(function(){e.createNew(),v(),u.go("balanceSheet"),l.$broadcast(i.BALANCE_SHEET_UPDATED),$.mainMenu.toggle()},function(){$.mainMenu.toggle()})}function A(e){if(e&&e.length){var n=new y;n.onload=function(){P(n.result)},n.readAsText(e[0]),$.mainMenu.toggle()}}function P(n){e.loadFromJson(n),v(),u.go("balanceSheet"),l.$broadcast(i.BALANCE_SHEET_UPDATED)}var $=this;$.mainMenu={toggle:d},$.init=h,$.createPerson=x,$.createExpense=S,$.createNewSheet=E,$.loadSheet=A,$.save=b,$.refresh=g;var w,D,C,y,N=c.confirm().title("Create new sheet").content("The current sheet will be discarded. Please consider exporting it first. Continue?").ok("Ok").cancel("Cancel");h()}{var a=e("angular"),o=e("lodash");e("./balance-sheet/balance-sheet")}a.module("debtApp").value("balanceSheetSaveCtrlConfig",{wait:500}).controller("DebtAppCtrl",r),r.$inject=["balanceSheetService","balanceSheetSaveCtrlConfig","openCreatePersonDialog","openCreateExpenseDialog","events","$mdDialog","$mdSidenav","$state","$scope","$window","$log"]},{"./balance-sheet/balance-sheet":4,angular:"angular",lodash:"lodash"}],8:[function(e,n,t){"use strict";function r(e){function n(n){return e(n)}function t(e){var n=[],t={};return a.forEach(e,function(e){var r,a=t[e.debtor.id];void 0===a&&(a=n.length,r={debtor:e.debtor,debts:[]},n.push(r),t[e.debtor.id]=a),r=n[a],r.debts.push({creditor:e.creditor,amount:e.amount})}),a.forEach(n,function(e){e.debts.sort(function(e,n){return e.creditor.name.localeCompare(n.creditor.name)})}),n.sort(function(e,n){return e.debtor.name.localeCompare(n.debtor.name)}),n}return{computeDebts:n,organizeByDebtor:t}}var a=e("angular");a.module("debtApp").factory("debtService",r),r.$inject=["solveDebts"]},{angular:"angular"}],9:[function(e,n,t){"use strict";function r(e){function n(e){if(!e||0===e.length)return[];var n=t(e);if(!r(n))return[];var a=c(n),o=s(a),i=l(o),u=p(i,a);return u}function t(e){var n={};return a.forEach(e,function(e){var t=n[e.person.id];void 0===t&&(t={person:e.person,balance:new o(0)},n[e.person.id]=t);var r=new o(e.paid),a=new o(e.share);t.balance=t.balance.add(a.subtract(r))}),a.forEach(n,function(e){e.balance=e.balance.toNumber()}),n}function r(e){var n=!1;return a.forEach(e,function(e){0!==e.balance&&(n=!0)}),n}function c(e){var n=[],t=[];return a.forEach(e,function(e){e.balance<=0?t.push(e):n.push(e)}),{debtors:n,creditors:t}}function s(e){for(var n=e.debtors.length,t=e.creditors.length,r=[],a=0;n>a;a++)r[a]=new o(e.debtors[a].balance).multiply(100).toNumber();for(var a=0;t>a;a++)r[n+a]=new o(e.creditors[a].balance).multiply(-100).toNumber();for(var i=u(n+t,n*t),a=0;n>a;a++)for(var c=a*t;(a+1)*t>c;c++)i[a][c]=1;for(var a=n;t+n>a;++a)for(var c=a-n;n*t>c;c+=t)i[a][c]=1;return{A:i,b:r}}function u(e,n){for(var t=[],r=0;e>r;r++){t[r]=[];for(var a=0;n>a;a++)t[r][a]=0}return t}function l(n){var t=e(n),r=t.numberOfVariables,o=t.numberOfFreeVariables;if(0===o)return t.xVector;var c=i.engines.mt19937();c.seed(20150312);var s;do{for(var u=a.copy(n.A),l=n.b,p=[],d=0;r>d;d++)p[d]=d;s=[];for(var d=0;o>d;d++){var h=i.integer(0,p.length-1)(c);s.push(p[h]),p.splice(h,1)}for(var d=0;d<u.length;d++)for(var v=0;v<s.length;v++)u[d][s[v]]=0;t=e({A:u,b:l})}while(!f(t.xVector));return t.xVector}function f(e){if(!e)return!1;for(var n=0;n<e.length;n++)if(e[n]<0)return!1;return!0}function p(e,n){for(var t=[],r=0;r<e.length;r++)if(0!==e[r]){var a=Math.floor(r/n.creditors.length),i=r-n.creditors.length*a,c=new o(e[r]).divideBy(100).toNumber(),s={debtor:n.debtors[a].person,creditor:n.creditors[i].person,amount:c};t.push(s)}return t}return n}var a=e("angular"),o=e("simple-decimal-money"),i=e("random-js");a.module("debtApp").factory("solveDebts",r),r.$inject=["solveLinearSystem"]},{angular:"angular","random-js":"random-js","simple-decimal-money":"simple-decimal-money"}],10:[function(e,n,t){"use strict";e("./lin-eq-solver"),e("./lin-eq-solver-factory"),e("./debt-solver"),e("./debt-service")},{"./debt-service":8,"./debt-solver":9,"./lin-eq-solver":12,"./lin-eq-solver-factory":11}],11:[function(e,n,t){"use strict";function r(){return a}var a=e("./lin-eq-solver"),o=e("angular");o.module("debtApp").factory("solveLinearSystem",r)},{"./lin-eq-solver":12,angular:"angular"}],12:[function(e,n,t){"use strict";function r(e){function n(){if(!e||!e.A||!e.b)throw"Null matrix A or vector b in system Ax = b";if(e.A.length<1||e.A[0].length<1)throw"Matrix A in Ax = b has no rows or no columns";if(e.A.length!=e.b.length)throw"The dimensions of the matrix and the constant vector are incompatible"}function t(){f=i(e.A),p=o(e.b),h=f.length,v=f[0].length,m=[];for(var n=0;h>n;n++)m[n]=n;S=[];for(var n=0;h>n;n++){S[n]=0;for(var t=0;v>t;t++){var r=Math.abs(f[n][t]);r>S[n]&&(S[n]=r)}}x=[];for(var t=0;v>t;t++)x[t]=t}function r(){for(var e=0,n=[];h-1>e;){for(var t=0,r=e,a=e;h>a;++a){var o=m[a],i=x[e],c=Math.abs(f[o][i]/S[o]);c>t&&(t=c,r=a)}if(0===t){var s=x[e];n[s]=!0;for(var a=e,u=s;u==s&&v-1>a;)++a,n[x[a]]||(u=x[a]);if(u!=s){x[e]=u,x[a]=s;continue}return}var l=m[e];m[e]=m[r],m[r]=l;var d=m[e],b=x[e];for(a=e+1;h>a;++a){for(var o=m[a],g=f[o][b]/f[d][b],E=e+1;v>E;++E){var A=x[E];f[o][A]=f[o][A]-g*f[d][A]}f[o][b]=0,p[o]=p[o]-g*p[d]}e++}}function c(){var e;for(e=Math.min(h,v)-1;e>0;--e){var n=m[e],t=x[e];if(0!==f[n][t])for(var r=e-1;r>-1;--r){for(var a=f[m[r]][x[e]]/f[m[e]][x[e]],o=0;v>o;++o)f[m[r]][x[o]]-=a*f[m[e]][x[o]];p[m[r]]-=a*p[m[e]]}}for(e=0;e<Math.min(h,v);++e)if(0!==f[m[e]][x[e]]){for(var i=f[m[e]][x[e]],o=0;v>o;++o)f[m[e]][o]=f[m[e]][o]/i;p[m[e]]=p[m[e]]/i}}function s(){b=0;var e,n;e:for(n=0;v>n;++n){for(e=0;h>e;++e){if(e!=n&&0!==f[m[e]][x[n]])break e;if(e==n&&1!=f[m[e]][x[n]])break e}++b}}function u(){for(var e=!0,n=b;h>n;++n)if(0!==p[m[n]]){e=!1;break}h>b&&!e?g=0:b!=v||b!=h&&!e?v>b&&(b==h||e)&&(g=Number.MAX_VALUE):g=1}function l(){if(0===g)d=void 0;else{d=a(v);for(var e=0;b>e;++e)d[x[e]]=p[m[e]]}}var f,p,d,h,v,b,g,m,x,S;return n(),t(),r(),c(),s(),u(),l(),{xVector:d,numberOfEquations:h,numberOfVariables:v,rank:b,numberOfFreeVariables:v-b,numberOfSolutions:g}}function a(e){for(var n=[],t=0;e>t;t++)n[t]=0;return n}function o(e){return e.slice()}function i(e){for(var n=[],t=0;t<e.length;t++)n[t]=e[t].slice();return n}n.exports=r},{}],13:[function(e,n,t){"use strict";function r(e){function n(){return e.show({templateUrl:"expenses/create-expense-dialog.html",controller:a,controllerAs:"vm"})}return n}function a(e){function n(){a.expense={name:void 0,sharing:"equal"},a.options={createParticipations:!0}}function t(){e.hide({expense:a.expense,options:a.options})}function r(){e.cancel()}var a=this;a.ok=t,a.cancel=r,a.init=n,n()}var o=e("angular");o.module("debtApp").factory("openCreateExpenseDialog",r),r.$inject=["$mdDialog"],a.$inject=["$mdDialog"]},{angular:"angular"}],14:[function(e,n,t){"use strict";function r(e,n,t,r,o,i,c){function s(){v.balanceSheet=e.balanceSheet,v.expense=v.balanceSheet.getExpense(o.id),v.isParticipant={},v.everyoneParticipates=!0,u(),c.$on(t.BALANCE_SHEET_UPDATED,function(e){e.targetScope!=c&&v.updateExpense()})}function u(){v.expense.shareCost(),v.isParticipant=l(),v.debtsByDebtor=h(),v.cost=v.expense.getCost(),v.sumOfShares=v.expense.getSumOfShares(),c.$emit(t.BALANCE_SHEET_UPDATED)}function l(){var e={};return a.forEach(v.balanceSheet.persons,function(n){e[n.id]=!1,a.forEach(v.expense.getParticipations(),function(t){t.person.equals(n)&&(e[n.id]=!0)})}),e}function f(e,n){n?v.balanceSheet.createParticipation({expense:v.expense,person:e}):v.balanceSheet.removeParticipation({expense:v.expense,person:e}),u()}function p(){r.show(b).then(d)}function d(){v.balanceSheet.removeExpense(v.expense),c.$emit(t.BALANCE_SHEET_UPDATED),i.go("balanceSheet")}function h(){if(v.expense.isBalanced()){var e=n.computeDebts(v.expense.getParticipations());return n.organizeByDebtor(e)}}var v=this,b=r.confirm().content("Really delete this expense?").ok("Ok").cancel("Cancel");v.init=s,v.setParticipation=f,v.updateExpense=u,v.removeExpense=p,s()}var a=(e("lodash"),e("angular"));a.module("debtApp").controller("ExpenseDetailCtrl",r),r.$inject=["balanceSheetService","debtService","events","$mdDialog","$stateParams","$state","$scope"]},{angular:"angular",lodash:"lodash"}],15:[function(e,n,t){"use strict";e("./route-config"),e("./expense-detail-ctrl"),e("./create-expense-dialog")},{"./create-expense-dialog":13,"./expense-detail-ctrl":14,"./route-config":16}],16:[function(e,n,t){"use strict";function r(e){e.state("expense",{url:"/expenses/:id",templateUrl:"expenses/expense-detail.html",controller:"ExpenseDetailCtrl as vm"})}var a=e("angular");a.module("debtApp").config(r),r.$inject=["$stateProvider"]},{angular:"angular"}],17:[function(e,n,t){"use strict";function r(e){return function(n){return n>0?"+"+e("number")(n,"2"):0>=n?e("number")(n,"2"):void 0}}{var a=e("angular");e("lodash")}a.module("debtApp").filter("balance",r),r.$inject=["$filter"]},{angular:"angular",lodash:"lodash"}],18:[function(e,n,t){"use strict";function r(e){function n(){return e.show({templateUrl:"persons/create-person-dialog.html",controller:a,controllerAs:"vm"})}return n}function a(e){function n(){a.person={name:void 0},a.options={createParticipations:!0}}function t(){e.hide({person:a.person,options:a.options})}function r(){e.cancel()}var a=this;a.ok=t,a.cancel=r,a.init=n,n()}var o=e("angular");o.module("debtApp").factory("openCreatePersonDialog",r),r.$inject=["$mdDialog"],a.$inject=["$mdDialog"]},{angular:"angular"}],19:[function(e,n,t){"use strict";e("./route-config"),e("./person-detail-ctrl"),e("./create-person-dialog"),e("./balance-filter")},{"./balance-filter":17,"./create-person-dialog":18,"./person-detail-ctrl":20,"./route-config":21}],20:[function(e,n,t){"use strict";function r(e,n,t,r,a,i,c,s){function u(){x.balanceSheet=e.balanceSheet,x.person=x.balanceSheet.getPerson(a.id),l(),m=i.confirm().content("Really delete this person?").ok("Ok").cancel("Cancel"),c.$on(t.BALANCE_SHEET_UPDATED,x.refresh)}function l(){x.isParticipant=f(),x.cost=x.person.getCost(),x.sumOfShares=x.person.getSumOfShares(),x.balance=x.person.getBalance();var e=h();x.debtRole=e.role,x.debts=e.debts}function f(){var e={};return o.forEach(x.balanceSheet.expenses,function(n){e[n.id]=!1,o.forEach(x.person.getParticipations(),function(t){t.expense.equals(n)&&(e[n.id]=!0)})}),e}function p(e){e.shareCost(),l(),c.$emit(t.BALANCE_SHEET_UPDATED)}function d(e,n){n?x.balanceSheet.createParticipation({expense:e,person:x.person}):x.balanceSheet.removeParticipation({expense:e,person:x.person}),x.updateExpense(e)}function h(){var e={role:void 0,debts:void 0};if(!x.balanceSheet.isBalanced())return e.role="unbalanced",e;if(x.balance>0)e.role="debtor";else{if(!(x.balance<0))return e.role="settled",e;e.role="creditor"}var t={debtor:"creditor",creditor:"debtor"},r=n.computeDebts(x.balanceSheet.getNonSettledParticipations());return e.debts=o.chain(r).filter(function(n){return n[e.role].equals(x.person)}).map(function(n){return{person:n[t[e.role]],amount:n.amount}}).value(),e}function v(){i.show(m).then(b)}function b(){x.balanceSheet.removePerson(x.person),c.$emit(t.BALANCE_SHEET_UPDATED),r.go("balanceSheet")}function g(){c.$emit(t.BALANCE_SHEET_UPDATED)}var m,x=this;x.init=u,x.refresh=l,x.updateExpense=p,x.setParticipation=d,x.removePerson=v,x.updatePerson=g,u()}var a=e("angular"),o=e("lodash");a.module("debtApp").controller("PersonDetailCtrl",r),r.$inject=["balanceSheetService","debtService","events","$state","$stateParams","$mdDialog","$scope","$log"]},{angular:"angular",lodash:"lodash"}],21:[function(e,n,t){"use strict";function r(e){e.state("person",{url:"/persons/:id",templateUrl:"persons/person-detail.html",controller:"PersonDetailCtrl as vm"})}var a=e("angular");a.module("debtApp").config(r),r.$inject=["$stateProvider"]},{angular:"angular"}],22:[function(e,n,t){"use strict";function r(e){e.otherwise("/")}var a=e("angular");a.module("debtApp").config(r),r.$inject=["$urlRouterProvider"]},{angular:"angular"}],23:[function(e,n,t){"use strict";e("./money-input-directive")},{"./money-input-directive":24}],24:[function(e,n,t){"use strict";function r(e){function n(e,n,o,i){function c(){n.val(i.$valid?r(i.$modelValue):i.$viewValue)}function s(){i.$render()}i.$validators.money=t,i.$parsers.push(a),i.$formatters.unshift(r),n.on("blur",s),i.$render=c}function t(e){return 0>e?!1:!0}function r(n){return void 0===n||null===n?"":e("number")(n,2)}function a(e){return new o(e).toNumber()}return{restrict:"A",require:"ngModel",link:n}}var a=e("angular"),o=(e("lodash"),e("simple-decimal-money"));a.module("debtApp").directive("moneyInput",r),r.$inject=["$filter"]},{angular:"angular",lodash:"lodash","simple-decimal-money":"simple-decimal-money"}]},{},[1]);
//# sourceMappingURL=debt.js.map